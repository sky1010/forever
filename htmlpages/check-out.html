    <!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Forever Grace">
    <meta name="keywords" content="ecommerce, Forever Grace">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Forever Grace</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css?family=Muli:300,400,500,600,700,800,900&display=swap" rel="stylesheet">

    <!-- Css Styles -->
    <link rel="stylesheet" href="../css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="../css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="../css/themify-icons.css" type="text/css">
    <link rel="stylesheet" href="../css/elegant-icons.css" type="text/css">
    <link rel="stylesheet" href="../css/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="../css/nice-select.css" type="text/css">
    <link rel="stylesheet" href="../css/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="../css/slicknav.min.css" type="text/css">
    <link rel="stylesheet" href="../css/style.css" type="text/css">
</head>

<body>
    <!-- Page Preloder -->
    <div id="preloder">
        <div class="loader"></div>
    </div>

    <!-- Header Section Begin -->
    <header class="header-section">
        <div class="container">
            <div class="inner-header">
                <div class="row">
                    <div class="col-lg-2 col-md-2">
                        <div class="logo">
                            <a href="./index.html">
                                <img src="../img/logo.png" alt="">
                            </a>
                        </div>
                    </div>
                    <div class="col-lg-5 col-md-5">
                    </div>
                    <div class="col-lg-3 col-md-2">
                        <div style="display:flex; justify-content:space-around; align-items: center;">
                            <div class="profile" data-toggle="tooltip" data-placement="top" title="Profile" id="profile_avatar"></div>
                            <p id="profile_name"></p>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-2">
                        <ul class="nav-right">
                            <li class="cart-icon"><a href="#">
                                <i class="icon_bag_alt"></i>
                                <span id ='card_count'>0</span>
                            </a>
                            <div class="cart-hover">
                                <div class="select-items">
                                    <table>
                                        <tbody id="cart_dataset">
                                        </tbody>
                                    </table>
                                </div>
                                <div class="select-total">
                                    <span>total:</span>
                                    <h5 id="sum_cart"></h5>
                                </div>
                                <div class="select-button">
                                    <a href="shopping-cart.html" class="primary-btn view-card">VIEW CARD</a>
                                    <a href="check-out.html" class="primary-btn checkout-btn">CHECK OUT</a>
                                </div>
                            </div>
                        </li>
                            <li id='sum_cart_2' class="cart-price">RS 0</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="nav-item">
            <div class="container">
                <nav class="nav-menu mobile-menu">
                    <ul>
                        <li><a href="../index.html">Home</a></li>
                        <li><a href="./shop.html">Shop</a></li>
                        <li><a href="./collection.html">Collection</a>
                        </li>
                        <li><a href="./contact.html">Contact</a></li>
                        <li><a href="./login.html">Login</a></li>
                        <li ><a href="./register.html">Register</a></li>
                    </ul>
                </nav>
                <div id="mobile-menu-wrap"></div>
            </div>
        </div>
    </header>
    <!-- Header End -->
    <!-- Breadcrumb Section Begin -->
    <div class="breacrumb-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb-text product-more">
                        <a href="../index.html"><i class="fa fa-home"></i> Home</a>
                        <a href="./shop.html">Shop</a>
                        <span>Check Out</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Breadcrumb Section Begin -->

    <!-- Shopping Cart Section Begin -->
    <section class="checkout-section spad">
        <div class="container">
            <form action="#" class="checkout-form">
                <div class="row">
                    <div class="col-lg-6">
                        <h4>Biiling Details</h4>
                        <div class="row">
                            <div class="col-lg-6">
                                <label for="fir">First Name<span>*</span></label>
                                <input type="text" id="fn">
                            </div>
                            <div class="col-lg-6">
                                <label for="last">Last Name<span>*</span></label>
                                <input type="text" id="ln">
                            </div>
                            <div class="col-lg-12">
                                <label for="cun">Country<span>*</span></label>
                                <input type="text" id="con">
                            </div>
                            <div class="col-lg-12">
                                <label for="street">Street Address<span>*</span></label>
                                <input type="text" id="street" class="street-first">
                            </div>
                            <div class="col-lg-12">
                                <label for="zip">Postcode / ZIP (optional)</label>
                                <input type="text" id="zip">
                            </div>
                            <div class="col-lg-12">
                                <label for="town">Town / City<span>*</span></label>
                                <input type="text" id="town">
                            </div>
                            <div class="col-lg-6">
                                <label for="email">Email Address<span>*</span></label>
                                <input type="text" id="email">
                            </div>
                            <div class="col-lg-6">
                                <label for="phone">Phone<span>*</span></label>
                                <input type="text" id="phone">
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="place-order">
                            <h4>Your Order</h4>
                            <div class="order-total">
                                <ul class="order-table">
                                    <li id="payment_cart_dataset">Product <span>Total</span></li>
                                    <!-- <li class="fw-normal">Combination x 1 <span>$60.00</span></li> -->
                                    <!-- <li class="fw-normal">Combination x 1 <span>$60.00</span></li>
                                    <li class="fw-normal">Combination x 1 <span>$120.00</span></li> -->
                                    <li class="total-price">Total <span id='total_payment'></span></li>
                                </ul>
                                <div class="order-btn">
                                    <!-- <button type="submit" class="site-btn place-btn">Place Order</button> -->
                                    <div id="paypal-button"></div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </section>
    <!-- Shopping Cart Section End -->

    <!-- Partner Logo Section Begin -->
    <div class="partner-logo">
        <div class="container">
            <div class="logo-carousel owl-carousel">
                <div class="logo-item">
                    <div class="tablecell-inner">
                        <img src="../img/logo-carousel/logo-1.png" alt="">
                    </div>
                </div>
                <div class="logo-item">
                    <div class="tablecell-inner">
                        <img src="../img/logo-carousel/logo-2.png" alt="">
                    </div>
                </div>
                <div class="logo-item">
                    <div class="tablecell-inner">
                        <img src="../img/logo-carousel/logo-3.png" alt="">
                    </div>
                </div>
                <div class="logo-item">
                    <div class="tablecell-inner">
                        <img src="../img/logo-carousel/logo-4.png" alt="">
                    </div>
                </div>
                <div class="logo-item">
                    <div class="tablecell-inner">
                        <img src="../img/logo-carousel/logo-5.png" alt="">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Partner Logo Section End -->

    <!-- Footer Section Begin -->
    <footer class="footer-section">
        <div class="container">
            <div class="row">
                 <div class="col-lg-4">
                 </div>
                <div class="col-lg-4">
                    <div class="footer-left">
                        <div class="footer-logo">
                            <a href="#"><img src="../img/footer-logo.png" alt=""></a>
                        </div>
                        <ul>
                            <li>Address: New Street Port Louis</li>
                            <li>Phone: +230 59876542</li>
                            <li>Email: forevergrace@gmail.com</li>
                        </ul>
                        <div class="footer-social">
                            <a href="#"><i class="fa fa-facebook"></i></a>
                            <a href="#"><i class="fa fa-instagram"></i></a>
                            <a href="#"><i class="fa fa-twitter"></i></a>
                            <a href="#"><i class="fa fa-pinterest"></i></a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                 </div>


            </div>
        </div>
        <div class="copyright-reserved">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="copyright-text">
                            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved to Forever Gracer
                        </div>
                        <div class="payment-pic">
                            <img src="../img/payment-method.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->
    <!-- Js Plugins -->
    <script src="../js/jquery-3.3.1.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/jquery-ui.min.js"></script>
    <script src="../js/jquery.countdown.min.js"></script>
    <script src="../js/jquery.nice-select.min.js"></script>
    <script src="../js/jquery.zoom.min.js"></script>
    <script src="../js/jquery.dd.min.js"></script>
    <script src="../js/jquery.slicknav.js"></script>
    <script src="../js/owl.carousel.min.js"></script>
    <script src="../js/functions.js"></script>
    <script src="../js/main.js"></script>
    <script src="https://www.paypalobjects.com/api/checkout.js"></script>
                                    <script>
                                        var user_session = JSON.parse(window.sessionStorage.getItem('user_metadata'));
                                        ajax(
                                            '../builder/bridge.php',
                                            { request_type: 'usercart', data:user_session.cart_id },
                                            {c: renderPaypal}
                                        );

                                    function renderPaypal(object){
                                        var deserialized_data = JSON.parse(object);
                                        var product_dataset = [];

                                        for(var i = 0; i < deserialized_data.length; i++){
                                            product_dataset.push({
                                                name: deserialized_data[i].prod_name,
                                                description: deserialized_data[i].prod_desc,
                                                quantity: deserialized_data[i].prod_qty,
                                                price: deserialized_data[i].inv_price,
                                                tax: '0.00',
                                                sku: "0".repeat(5) + deserialized_data[i].inv_price,
                                                currency: 'USD'
                                            });
                                        }
                                        paypal.Button.render({
                                            // Configure environment
                                            env: 'sandbox',
                                            client: {
                                            sandbox: 'demo_sandbox_client_id',
                                            production: 'demo_production_client_id'
                                            },
                                            // Customize button (optional)
                                            locale: 'en_US',
                                            style: {
                                            size: 'small',
                                            color: 'gold',
                                            shape: 'pill',
                                            },

                                            // Enable Pay Now checkout flow (optional)
                                            commit: true,

                                            // Set up a payment
                                            payment: function(data, actions) {
                                            var fullname = $('#fn').val()+' '+$('#ln').val();
                                            var street = $('#street').val(); 
                                            var town = $('#town').val(); 
                                            var zip = $('#zip').val();
                                            var phone = $('#phone').val();
                                            var amount = $('#total_payment').text().replace( /^\D+/g, '');
                                            // var totalamount = parseFloat(amount/40);
                                            return actions.payment.create({
                                                transactions: [{
                                                    amount: {
                                                        total: amount,
                                                        currency: 'USD',
                                                        details: {
                                                        subtotal: amount,
                                                        tax: '0.00',
                                                        shipping: '0.00',
                                                        handling_fee: '0.00',
                                                        shipping_discount: '0.00',
                                                        insurance: '0.00'
                                                        }
                                                    },
                                                description: 'The payment transaction description.',
                                                custom: '90048630024435',

                                                item_list: {
                                                    items: product_dataset
                                                    ,

                                                    shipping_address: {
                                                    recipient_name: fullname,
                                                    line1: street,
                                                    line2: '',
                                                    city: town,
                                                    country_code: 'MU',
                                                    postal_code: zip,
                                                    phone: phone,
                                                    state: 'MU'
                                                    }
                                                }
                                                }],
                                                note_to_payer: 'Contact us for any questions on your order.'
                                            });
                                            },
                                            // Execute the payment
                                            onAuthorize: function(data, actions) {
                                            return actions.payment.execute().then(function() {
                                                // Show a confirmation message to the buyer
                                                const user_metadata = JSON.parse(window.sessionStorage.getItem("user_metadata"));
                                                    emptyContent("#shopping_dataset");
                                                    emptyContent("#cart_dataset");
                                                    ajax(
                                                        '../builder/bridge.php',
                                                        { request_type: 'deleteAll', data:user_metadata.cart_id },
                                                        {c: shoppingusercart}
                                                    );
                                                    ajax(
                                                        '../builder/bridge.php',
                                                        { request_type: 'deleteAll', data:user_metadata.cart_id },
                                                        {c: showusercart}
                                                    );
                                                    ajax(
                                                        '../builder/bridge.php',
                                                        { request_type: 'insertpayment', cart_id:user_metadata.cart_id, date:new Date() ,user_id:user_metadata.user_id, amount:$('#total_payment').text().replace( /^\D+/g, '') },
                                                        {c: insertpayment}
                                                    );

                                                    for(var i = 0; i < deserialized_data.length; i++){
                                                        ajax(
                                                        '../builder/bridge.php',
                                                        { request_type: 'insertpaidproduct', cart_id:user_metadata.cart_id, product_id:deserialized_data[i].product_id ,
                                                        product_price:deserialized_data[i].inv_price, product_qty:deserialized_data[i].prod_qty, date:new Date() },
                                                        {c: insertpaidproduct}
                                                    );   
                                                    }

                                                window.alert('Thank you for your purchase!');
                                                window.location.href = 'collection.html';

                                            });
                                            }
                                        }, '#paypal-button');
                                    }        
                                    </script>
</body>

</html>  
   
